<div class="process-edit-form">
  <mat-vertical-stepper [linear]="true">
    <mat-step [stepControl]="nameFormControl">
      <ng-template matStepLabel>Definition</ng-template>
      <mat-form-field>
        <mat-label>Name</mat-label>
        <input matInput [formControl]="nameFormControl">
      </mat-form-field>
      <br>
      <button mat-button (click)="redirectToList()">Cancel</button>
      <button mat-button matStepperNext>Next</button>
    </mat-step>
    <mat-step>
      <ng-template matStepLabel>Preview</ng-template>
      <mat-card>

        <mat-card-header>
          <mat-card-title *ngIf="isUpdateProcess">Process</mat-card-title>
          <mat-card-title *ngIf="!isUpdateProcess">New Process</mat-card-title>
        </mat-card-header>

        <mat-card-content>
          <div fxLayout="row" fxLayoutAlign="space-between stretch">
            <div class="mat-body-strong">Name:</div>
            <div>{{nameFormControl.valueChanges | async}}</div>
          </div>
          <ng-container *ngIf="selectedProcess">
            <div fxLayout="row" fxLayoutAlign="space-between stretch">
              <div class="mat-body-strong">Created at:</div>
              <div>{{selectedProcess.createdAt | date}}</div>
            </div>
            <div fxLayout="row" fxLayoutAlign="space-between stretch">
              <div class="mat-body-strong">Last updated at:</div>
              <div>{{selectedProcess.updatedAt | date}}</div>
            </div>
          </ng-container>
        </mat-card-content>

        <mat-card-actions *ngIf="nameFormControl.untouched">
          <button mat-button *ngIf="nameFormControl.untouched" (click)="redirectToList()">Back To List</button>
        </mat-card-actions>

        <mat-card-actions *ngIf="nameFormControl.touched" align="end">
          <button mat-raised-button (click)="redirectToList()">Cancel</button>
          <button *ngIf="!!selectedProcess"
                  mat-raised-button
                  color="primary"
                  [disabled]="nameFormControl.invalid"
                  (click)="onUpdateProcess(selectedProcess.id, nameFormControl.value, selectedProcess.version)">
            Save Process
          </button>
          <button *ngIf="!selectedProcess"
                  mat-raised-button
                  color="primary"
                  [disabled]="nameFormControl.invalid"
                  (click)="onCreateProcess(this.nameFormControl.value)">
            Create Process
          </button>
        </mat-card-actions>

      </mat-card>
    </mat-step>
  </mat-vertical-stepper>
</div>
